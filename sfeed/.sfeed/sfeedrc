#!/bin/sh
# File: sfeedrc
# Maintainer: Chris Fröschl <cfroeschl@protonmail.com>
# Last Modified: Wed 23 Dec 2020 03:33:16 PM CET
# License:
# Copyright (c) 2020 Chris Fröschl.
#
# Description:
# Main sfeed config file containing overrides and RSS URLs.

# list of feeds to fetch:
feeds() {
	# feed <name> <feedurl> [basesiteurl] [encoding]
	feed '4chan g' 'https://boards.4channel.org/g/index.rss'
	feed 'Hacker News' 'https://news.ycombinator.com/rss'
	feed 'Richard Stallman' 'https://stallman.org/rss/rss.xml'
	feed 'Luke Smith Podcast' 'https://notrelated.libsyn.com/rss'
	feed 'Luke Smith Blog' 'https://lukesmith.xyz/rss.xml'
	feed 'Luke Smith Videos' 'https://videos.lukesmith.xyz/feeds/videos.atom?sort=-trending'
	feed 'Planet GNU' 'https://planet.gnu.org/rss20.xml'
	feed 'Planet Gentoo' 'https://planet.gentoo.org/universe/atom.xml'
	feed 'suckless.org' 'https://suckless.org/atom.xml'
        feed 'cat -v' 'http://harmful.cat-v.org/Blog/index.rss'
	feed 'Tor' 'https://blog.torproject.org/rss.xml'
}

# Fetch a feed via TOR proxy as long as it's not one of the soy providers who
# keep blocking TOR requesters.
# fetch(name, url, feedfile)
fetch() {
    if [ "$2" = "https://boards.4channel.org/g/index.rss" ]; then
        curl --max-redirs 0 -L -m 15 -H "User-Agent:" -f -s "$2" 2>/dev/null
    else
        curl --max-redirs 0 -L -m 15 -H "User-Agent:" -f -s --socks5-hostname localhost:9050 "$2" 2>/dev/null
    fi
}
